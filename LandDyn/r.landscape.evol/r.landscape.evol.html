<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">     
<html>                                                              
<head>                                                              
<title>GRASS GIS: r.landscape.evol</title>                          
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" href="grassdocs.css" type="text/css">            
</head>                                                                 
<body bgcolor="white">                                                  

<img src="grass_logo.png" alt="GRASS logo"><hr align=center size=6 noshade>

<h2>NAME</h2>
<em><b>r.landscape.evol</b></em>  - Create raster maps of net erosion/depostion, the modified terrain surface (DEM) after net erosion/deposition using the USPED equation, bedrock elevations after soil production, and soil depth maps. This module uses appropriate flow on different landforms by default; however, singular flow regimes can be chosen instead. THIS SCRIPT WILL PRODUCE MANY TEMPORARY MAPS AND REQUIRES A LOT OF FREE FILE SPACE!                                                                                                    
<h2>KEYWORDS</h2>                                                                                                                                                                   
<h2>SYNOPSIS</h2>                                                                                                                                                                   
<b>r.landscape.evol</b><br>                                                                                                                                                         
<b>r.landscape.evol help</b><br>                                                                                                                                                    
<b>r.landscape.evol</b> [-<b>glkezbyncmtsvauwrdf</b>] <b>elev</b>=<em>string</em> <b>initbdrk</b>=<em>string</em> <b>prefx</b>=<em>string</em> <b>outdem</b>=<em>string</em> <b>outsoil</b>=<em>string</em>  [<b>outbdrk</b>=<em>string</em>]   [<b>statsout</b>=<em>string</em>]  <b>R</b>=<em>string</em> <b>K</b>=<em>string</em> <b>sdensity</b>=<em>string</em> <b>C</b>=<em>string</em> <b>kappa</b>=<em>string</em> <b>cutoff1</b>=<em>string</em> <b>cutoff2</b>=<em>string</em> <b>number</b>=<em>integer</em> <b>nbhood</b>=<em>string</em> <b>method</b>=<em>string</em>  [--<b>verbose</b>]  [--<b>quiet</b>]                                                                                                                       

<h3>Flags:</h3>
<DL>           
<DT><b>-g</b></DT>
<DD>-g do not put header on statsout text file and always append data, even if file already exists (useful if script is being run by an outside program)</DD>

<DT><b>-l</b></DT>
<DD>-l Do not output maps of soil depths</DD>

<DT><b>-k</b></DT>
<DD>-k Keep all intermediate files as well</DD>

<DT><b>-e</b></DT>
<DD>-e Keep initial soil depths map</DD>

<DT><b>-z</b></DT>
<DD>-z Keep region zoomed to output maps</DD>

<DT><b>-b</b></DT>
<DD>-b Use static bedrock elavations (do not create new soil)</DD>

<DT><b>-y</b></DT>
<DD>-y Smooth the map every year (Uesful if artifacts appear on unsmoothed output maps)</DD>

<DT><b>-n</b></DT>
<DD>-n Output maps of net elevation change for every cycle</DD>

<DT><b>-c</b></DT>
<DD>-c Output cumulative erosion/deposition map from data for all iterations</DD>

<DT><b>-m</b></DT>
<DD>-m Output mean erosion/depostition map from data for all iterations (must check -n as well)</DD>

<DT><b>-t</b></DT>
<DD>-t Output standard deviation of erosion/depostition map from data for all iterations (must check -n as well)</DD>

<DT><b>-s</b></DT>
<DD>-s Output mean soil depths map from data for all iterations</DD>

<DT><b>-v</b></DT>
<DD>-v Output standard deviation soil depths map from data for all iterations</DD>

<DT><b>-a</b></DT>
<DD>-a Output maximum soil depths map from data for all iterations</DD>

<DT><b>-u</b></DT>
<DD>-u Output minimum soil depths map from data for all iterations</DD>

<DT><b>-w</b></DT>
<DD>-w Calcuate for only sheetwash across entire map</DD>

<DT><b>-r</b></DT>
<DD>-r Calcuate for only channelized flow across entire map</DD>

<DT><b>-d</b></DT>
<DD>-d Calcuate for only diffusive flow (soil creep) across entire map</DD>

<DT><b>-f</b></DT>
<DD>-f Use r.terrflow instead of r.watershed to calculate flow accumulation ( GRASS 6.3.x users MUST use this flag!)</DD>

<DT><b>--verbose</b></DT>
<DD>Verbose module output</DD>
<DT><b>--quiet</b></DT>       
<DD>Quiet module output</DD>  
</DL>                         

<h3>Parameters:</h3>
<DL>                
<DT><b>elev</b>=<em>string</em></DT>
<DD>Input elevation map (DEM)</DD>  

<DT><b>initbdrk</b>=<em>string</em></DT>
<DD>Initial bedrock elevations map (for first iteration only)</DD>
<DD>Default: <em></em></DD>                                       

<DT><b>prefx</b>=<em>string</em></DT>
<DD>Prefix for all output maps</DD>  
<DD>Default: <em>levol_</em></DD>    

<DT><b>outdem</b>=<em>string</em></DT>
<DD>Name stem for output elevation map(s) (preceded by prefix and followed by numerical suffix if more than one iteration)</DD>
<DD>Default: <em>elevation</em></DD>                                                                                           

<DT><b>outsoil</b>=<em>string</em></DT>
<DD>Name stem for the output soil depth map(s) (preceded by prefix and followed by numerical suffix if more than one iteration)</DD>
<DD>Default: <em>soildepth</em></DD>

<DT><b>outbdrk</b>=<em>string</em></DT>
<DD>Name stem for the output bedrock map(s) (required if the -b option is NOT checked; preceded by prefix and followed by numerical suffix if more than one iteration)</DD>
<DD>Default: <em>bedrock</em></DD>

<DT><b>statsout</b>=<em>string</em></DT>
<DD>Name for the statsout text file (optional, if none provided, a default name will be used)</DD>

<DT><b>R</b>=<em>string</em></DT>
<DD>Rainfall (R factor) constant (AVERAGE FOR WHOLE MAP AREA)</DD>
<DD>Default: <em>5.66</em></DD>

<DT><b>K</b>=<em>string</em></DT>
<DD>Soil erodability index (K factor) map or constant</DD>
<DD>Default: <em>0.42</em></DD>

<DT><b>sdensity</b>=<em>string</em></DT>
<DD>Soil density constant (for conversion from mass to volume)</DD>
<DD>Default: <em>1.2184</em></DD>

<DT><b>C</b>=<em>string</em></DT>
<DD>Landcover index (C factor) map or constant</DD>
<DD>Default: <em>0.001</em></DD>

<DT><b>kappa</b>=<em>string</em></DT>
<DD>Hillslope diffusion (Kappa) rate map or constant (meters per kiloyear)</DD>
<DD>Default: <em>1</em></DD>

<DT><b>cutoff1</b>=<em>string</em></DT>
<DD>Flow accumultion breakpoint value for shift from diffusion to overland flow (number of cells)</DD>
<DD>Default: <em>4</em></DD>

<DT><b>cutoff2</b>=<em>string</em></DT>
<DD>Flow accumultion breakpoint value for shift from overland flow to channelized flow (number of cells)</DD>
<DD>Default: <em>50</em></DD>

<DT><b>number</b>=<em>integer</em></DT>
<DD>number of iterations (cycles) to run</DD>
<DD>Default: <em>1</em></DD>

<DT><b>nbhood</b>=<em>string</em></DT>
<DD>Band-pass filter neighborhood size</DD>
<DD>Options: <em>1,3,5,7,9,11,13,15,17,19,21,23,25</em></DD>
<DD>Default: <em>3</em></DD>

<DT><b>method</b>=<em>string</em></DT>
<DD>Neighborhood smoothing method</DD>
<DD>Options: <em>average,median,mode</em></DD>
<DD>Default: <em>median</em></DD>

</DL>
<h2>DESCRIPTION</h2>

<p><em>r.landscape.evol</em> takes as input a raster digital elevation
model (DEM) of surface topography and an input raster DEM of bedrock elevations,
 as well as several environmental variables, and computes  the net change in elevation due to erosion and deposition using the USPED equation. The module has the ability to run recursively, looping over several iterations. The time interval represneted by each iteration is determined by the scale of the input environmental variables. The script creates a new map where each raster
cell carries a numerical value, which represents the simulated meters
of erosion or deposition (ED) estimated for that cell, under the
specified conditions of rainfall intensity, soil erodability, water
flow, and vegetation cover. This map of net ED is then added to (for
deposition) or subtracted from (for erosion) the topography map of
the previous time step, to create a new topography map (i.e., as a
DEM) after a cycle of landuse and landscape change.</P>
<p>
<p> <b>R</b>, <b>K</b>, and <b>C</b> are environmental factors relating to the intensity of yearly rainfall, the erodability of soil, and the degree to which vegetation cover prevents erosion (See below for a detailed description of these factors). <b>cutoff1</b>, and <b>cutoff2</b> are values of flow accumulation (number of upslope contributing cells) that determine where surface processes change from soil-creep to overland (laminar) flow and from overland flow to channelized (turbulent) flow respectively. <b>kappa</b> is the rate of diffusion for soil-creep in meters per 1000 years. <b>sdensity</b> is the density of the soil in grams per cubic centimeters. These measures are all determined empirically for a given landscape under a given climatic condition. 
<p>
<p>By default, <em>r.watershed</em> is used to calculate flow accumulation modeling (currently only using SFD alglrithm). In GRASS 6.4 and higher, this will result in drastically faster run times, but in GRASS 6.3 and lower, this will result in drastically slower run times. Therefore, users of GRASS 6.3 and lower are encouraged to use flag <b>-f</b> whcih will use <em>r.terraflow</em> for flow accuulation modeling instead.
<p>If the output of an initial run shows artifacts, the user may opt to smooth the DEM at each time step. The user may also opt to also create maps of various statistical measures from the output of all iterations, and the <b>statsout</b> option defines the name of the file that contains the
statistics of erosion, deposition, and soil depths over all iterations. The default name is <tt>"mapset"_"prefix"_lsevol_stats.txt</tt>
(in the users home directory).

</p>
<h2>CALCULATING SURFACE EROSION AND DEPOSITION</h2></P>
<P>Because physical
laws that govern the flow of water across landscapes and its ability
to erode, entrain, transport, and deposit sediments can be expressed
in mathematical form, they can be translated into a scripting
algorithm that modifies raster landscapes (i.e., in the GIS) in ways
analogous to the ways in which real-world landscapes change. There
are various mathematical expressions of the relevant surface
processes in the geomorphological literature—depending for example
on the processes selected to be represented, the simplicity of
representation desired, and the degree of resolution desired (Clevis,
et al. 2006; Degani, et al. 1979; Mitas and Mitasova 1998; Mitasova,
Hofierka, et al. 1996; Mitasova and Mitas 2001a, b; Peeters, et al.
2006; Singh and Phadke 2006; Warren, et al. 2005; Wischmeier, et al.
1971; Wischmeier and Smith 1978). We use the Unit Stream Power
Erosion-Deposition (USPED) equation, derived in part from the
widely-used Revised Universal Soil Loss Equation (RUSLE) (American
Society of Agricultural Engineers 2003; Degani, et al. 1979;
Mitasova, et al. 2001; Mitasova, Mitas, et al. 1996; Mitasova, et al.
2004; Singh and Phadke 2006; Warren, et al. 2005; Wischmeier 1976;
Wischmeier, et al. 1971; Wischmeier and Smith 1978), to calculate net
erosion and deposiiton across each landscape cell. USPED was
developed for hillslopes, small watersheds, and small channels (i.e.,
rills and gullies) (Warren, et al. 2005); it is less applicable to
larger streams and rivers. This makes it useful for many
archaeological settings including arid, semi-arid, and xeric regions
like those that surround much of the Mediterranean basin. 
</P>
<P>Net erosion and deposition rates are
computed from the change in sediment flow across cells of a DEM. We
approximate sediment flow rate from sediment transport capacity,
assuming that water flowing over landscapes normally carries sediment
at capacity. Transport capacity is calculated by combining a rainfall
coefficient (R, MJ mm/ha h yr), soil erodability coefficient (K, Mg
ha h/ha MJ mm), and coefficient for the ability of vegetation to
prevent erosion (C, unitless) from RUSLE with with an estimate of
topographically driven stream power as shown in equation (1)</P>
<P><I>T = R K C A</I><SUP><I>m</I></SUP><I>
(sin </I><I>B</I></FONT><I>)</I><SUP><I>n</I></SUP></P>
<P>where A is the upslope contributing
area (a measure of water flowing through a cell) and <em>B</em>
</I> is the slope of the cell. The exponents <em>m</em> and <em>n</em> are
empirically derived and vary for water flowing over nearly level
ground, on hillslopes, in water catchments at the heads of gullies,
or in small channels. The sediment flow rate is largely determined by
the amount of water flowing (contributing area), its velocity (a
function of slope), the erodability of the substrate (K factor), and
the ability of the vegetation cover to prevent erosion (C factor).
</P>
<P>Net erosion and
deposition rates are then computed as change in sediment flow in the
x and y directions across a cell, as shown in equation (2)</P>
<P><IMG SRC="r.landscape.evol_html_de331ef.gif" NAME="Object2" ALIGN=ABSMIDDLE WIDTH=223 HEIGHT=40>
<P>where ED is net erosion or deposition
rate for sediment and <em>alpha</em> is the
topographic aspect (i.e., direction of slope) for a cell. Whether
flowing water will erode or deposit sediment in a particular cell is
determined by the <em>change</em> in sediment flow (transport capacity)
from one cell to the next. If the transport capacity increases (for
example, due to an increase in the steepness of the slope or amount
of flowing water), more sediment will be entrained and erosion will
occur; if the transport capacity decreases (for example, due to a
decrease in slope or water flow) sediment will be deposited.</P>
<P>
<P>Implementing the
USPED algorithm in a GRASS script combines GIS modules for
calculating slope, aspect, and flow accumulation (the amount of water
that flows across each cell) using map algebra. Data used by the
script includes a map of initial surface topography (a raster DEM),
soil erodability (a constant for uniform soil or a raster map for
variable soil), vegetation cover (a constant or raster map), and
rainfall intensity (a constant only). We also create an underlying
bedrock topography map (a raster DEM) to limit the total depth of
unconsolidated sediment that can be eroded. Soil erodability,
vegetation cover, and rainfall are expressed as the K-factor,
C-factor, and R-factor components of the RUSLE and have been
calculated empirically for a variety of setting
(Boellstorff and Benito 2005 Martínez-Casasnovas, 2000 #4092; Essa
2004; Hammad, et al. 2004; Renard, et al. 1997; Renard and Freimund
1994). 

<p>The output of this GRASS implementation of USPED must be modified in several ways in order to make it appropriate for landscape evolution simulation. First, because of the way slope is calculated in <em>r.slope.aspect</em>, the flux "T" is actually calculeted one cell downslope from where is really occurs. This causes problems when USPED is iterated over many cycles, and creates oscillating "spikes" in positive and negative flux values resulting in the calculation of alternating deep pits and high mounds at sensitive areas on the landscape. To overcome this, <em>r.landscape.evol</em> uses a nieghborhood algorithm in <em>r.mapcalc</em> to put the calcualted value of "T" back into the cell that is most uplsope from where it is originally calculated.
<p>
<p>Additionally, control must be kept for the amount of erodable sediment available to moved. <em>r.landscape.evol</em> explicitly tracks this by taking the difference between the input bedrcok elevation DEM, and the current surface topography DEM, and creating a map of "soil" depth. This map tracks the amount of material assumed to be available for entrainment and transport by surface processes. A simple logical algorithm is used to prevent unduly large amounts of erosion from being calculated in areas devoid of erodable materials (ie. at bedrock outcrops). Where this condition occurs, K is made to be very small, resulting in only extremely small amounts of erosion.
<p>
<p> Another major issue is that the total flux "T" is in units of Mg/Ha, which means it must be converted in order to calculate the change in elevation at each cell. This is done via a simple algorithm that uses the density of the soil and the cell resolution. First, "T" is multiplied by 100, to convert the flux rate to grams/square meter. This new rate is multiplied by the resolution to calculate grams flux per cell width. This is then divided by soil density to calculate cubic centimeters per cell width, which is in turn divided by the area of the cell in centimeters (resolution squared x 100 squared) to get vertical change per cell width in centimeters. Finally, this measure is divided by 100, which converts it into  meters. Several of these factors cancel out to make a final equation of "T/(10,000*soildensity*resolution)". This equation changes the orignal T from Mg/Ha to vertical change in meters over the length of one cell's width.  In order to convert the output back to Mg/Ha (standard rate for USPED/RUSLE equations), you can multiply the netchange output map by "(10000 x resolution x soil density)" to create a map of soil erosion/deposition rates across the landscape. 
</dl>

<h2>SEE ALSO</h2>
<ul>
  <li>The <a
href="http://medland.asu.edu">MEDLAND</a> project at Arizona State University
       
  <li><a href="r.watershed.html">r.watershed</a>,
      <a href="r.terraflow.html">r.terraflow</a>,
      <a href="r.mapcalc.html">r.mapcalc</a>

       
</ul>

<h2>REFERENCES</h2>
<p>
</p>
<p>American Society of Agricultural Engineers
	2003	Honoring the Universal Soil Loss Equation: Historic Landmark Dedication Pamphlet. Purdue University Department of Agricultural and Biological Engineering.
<p>Clevis, Q., G. E. Tucker, G. Lock, S. T. Lancaster, N. Gasparini, A. Desitter and R. L. Bras
	2006	Geoarchaeological simulation of meandering river deposits and settlement distributions: A three-dimensional approach. Geoarchaeology 21(8):843-874.
<p>Degani, A., L. A. Lewis and B. B. Downing
	1979	Interactive Computer Simulation of the Spatial Process of Soil Erosion. Professional Geographer 31(2):184-190.
<p>Mitas, L. and H. Mitasova
	1998	Distributed soil erosion simulation for effective erosion prevention. Water Resources Research 34(3):505-516.

<p>Mitasova, H., J. Hofierka, M. Zlocha and L. R. Iverson
	1996	Modelling topographic potential for erosion and deposition using GIS. International Journal of Geographical Information Systems 10(5):629-641.

<p>Mitasova, H. and L. Mitas
	2001a	Modeling Physical Systems. In Geographic Information Systems and Environmental Modeling, edited by B. O. Parks, M. Crane and K. C. Clarke, pp. 189-210. Prentice Hall, New York.

	2001b	Multiscale soil erosion simulations for land use management. In Landscape erosion and landscape evolution modeling, edited by R. Harmon and W. Doe, pp. 321-347. Kluwer Academic/Plenum Publishers, New York.

<p>Mitasova, H., L. Mitas and W. M. Brown
	2001	Multiscale simulation of land use impact on soil erosion and deposition patterns. In Sustaining the Global Farm. Selected Papers from the 10th International Soil Conservation Organization Meeting, May 1999, Purdue University, edited by D. E. Stott, R. H. Mohtar and G. C. Steinhardt, pp. 1163-1169. USDA-ARS National Soil Erosion Research Laboratory, Purdue.

<p>Mitasova, H., L. Mitas, W. M. Brown and D. Johnston
	1996	Multidimensional Soil Erosion/Deposition Modeling Part III: Process based erosion simulation. Geographic Modeling and Systems Laboratory, University of Illinois at Urban-Champaign.
<p>Mitasova, H., C. Thaxton, J. Hofierka, R. McLaughlin, A. Moore and M. L
	2004	Path sampling method for modeling overland water flow, sediment transport and short term terrain evolution in Open Source GIS. In Proceedings of the XVth International Conference on Computational Methods in Water Resources (CMWR XV), edited by C. T. Miller, M. W. Farthing, V. G. Gray and G. F. Pinder, pp. 1479-1490. Elsevier, Chapel Hill, NC, USA.
<p>Peeters, I., T. Rommens, G. Verstraeten, G. Govers, A. Van Rompaey, J. Poesen and K. Van Oost
	2006	Reconstructing ancient topography through erosion modelling. Geomorphology 78(3-4):250-264.
<p>Rawls, W. J.
	1983	Estimating soil bulk denisty from particle size analysis and organic matter content. Soil Science 135(2):123.
<p>Renard, K. G., G. R. Foster, G. A. Weesies, D. K. McCool and D. C. Yoder
	1997	Predicting soil erosion by water: a guide to conservation planning with the Revised Universal Soil Loss Equation (RUSLE). In Agriculture Handbook, pp. 1–251. vol. 703. US Department of Agriculture, Washington, DC.

<p>Renard, K. G. and J. R. Freimund
	1994	Using monthly precipitation data to estimate the R-factor in the revised USLE. Journal of Hydrology 157(1-4):287-306.
<p>Singh, R. and V. S. Phadke
	2006	Assessing soil loss by water erosion in Jamni River Basin, Bundelkhand region, India, adopting universal soil loss equation using GIS. Current Science 90(10):1431-1435.
<p>Warren, S. D., H. Mitasova, M. G. Hohmann, S. Landsberger, F. Y. Iskander, T. S. Ruzycki and G. M. Senseman
	2005	Validation of a 3-D enhancement of the Universal Soil Loss Equation for prediction of soil erosion and sediment deposition. Catena 64:281-296.

<p>Wischmeier, W. H.
	1976	Use and Misuse of the Universal Soil Loss Equation. Journal of Soil and Water Conservation 31:5-9.

<p>Wischmeier, W. H., C. B. Johnson and B. V. Cross
	1971	A Soil Erodibility Nomograph for Farmland and Construction Sites. Journal of Soil and Water Conservation 26:189-92.

<p>Wischmeier, W. H. and D. D. Smith
	1978	Predicting Rainfall-Erosion Losses - A Guide to Conservation Planning. USDA Agriculture Handbook 282.



</DL>

</ol>

<p>
<i>Last changed: $Date: 2009-23-1 (Fri, 21 Jan 2009) $</i>
<HR>
<P><a href="index.html">Main index</a> - <a href="raster.html">raster index</a> - <a href="full_index.html">Full index</a></P>
<P>&copy; 2003-2009 <a href="http://grass.osgeo.org">GRASS Development Team</a></p>

</body>
</html>