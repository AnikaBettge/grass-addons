<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>GRASS GIS: r.broscoe.sh</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" href="grassdocs.css" type="text/css">
</head>
<body bgcolor="white">
<img src="grass_logo.png" alt="GRASS logo"><hr align=center size=6 noshade>
<h2>NAME</h2>
<em><b>r.broscoe.sh</b></em>

<h2>DESCRIPTION</h2>

<em>r.broscoe.sh</em> Calculates waerden test and t test statistics for some values of threshold area on a single basin, according to A.J.Broscoe theory (1959).<br />
The program uses some <em><a href="http://www.r-project.org/">R</a></em> commands for statistical analisys and graphic rapresentation. In particoular the R package <em>"agricolae"</em> is required.<br />
The A.J.Broscoe theory is well known as the theory of the "Mean Stream Drop" and it says that, for the extraction by DEM of a stream network, exists a threshold value wich makes <em>drop</em> constant, and this is the <em>right</em> one extraction threshold. <br />
By definig the <em>drop</em> (H) as:<br />
<br />
<em>H = S L</em><br />
<br />
for streams in each Strahler order. <br />
The <em>drop</em> is calculated as the quote difference by ending and starting point of a stream; S is the slope and L is the lenght of the same stream.<br />
Using the Leopold and Miller relation (1964):<br />
<br />
<em>S=CA<sup>t</sup></em><br />
<br />
where C and t are constat values; the area we are searching (A) is the lowest that gives S to find H costant for each Strahler order (w).<br />
<br />
<em>H<sub>w</sub> = H<sub>w+1</sub> = H<sub>w+2</sub> = ...</em><br />
<br />
where H<sub>w</sub> is the <em>mean</em> of the drops related to the streams in the same Strahler order (w).<br />
The area can be found by making some attempts for different area thresholds, doing some statistical tests (Van der Waerden test and linear regression), and choosing the <em>right</em> threshold from the output of the tests.<br />
<br />
<em>r.broscoe.sh</em> takes in input the DEM, the threshold values on wich calculate statistics, the outlet coords of the basin you want to study; it returns a table (text file) with the output of the Van der Waerden test and linear regression (t test) for each threshold value.<br />
For the Van der Waerden test the parameter <em>Pvalue</em> is taken. It has to be greater than the possible, it represents the possibility of success of the test (the <em>Mean Stream Drop</em> is the same for all Strahler orders).<br />
For the linear regression the parameters <em>t, Pr, R_squared_adj</em> are taken. <em>t</em> is the t statistic value, <em>Pr</em> is the possibility of success of the t test, <em>R_squared_adj</em> measures the dispersion of data around the mean value (for each order) for given degrees of freedom.<br />
Three graphics called "linear_regression", "waerden_test" and "all_tests" are also generated as PDF in the home folder.<br />
<br />
Preferably let's take the threshold value wich gives <em>Pvalue</em> (or <em>Pr</em>) greater than 0.95, but is not granted that you can reach that result because it depends of the well-graduation (by Horton-Strahler) of the basin, its geomorphological maturity, so it is not rare that you have to take threshold where <em>Pvalue</em> is simlpy the greatest.<br />
At the end of the calculation, at first <em>Pvalue</em> is examinated, then, only if Van der Waerden test gives no good results (low <em>Pvalue</em>), the linear regression output (<em>Pr</em>) is examinated; in fact the Van der Waerden test is preferred to linear regression because it allows you to consider the real dispersion of data around the mean: this makes you able to know the real significance of the probability (e.g. the significance is low for few data in the sample) considering an unique parameter.<br />
<br />
<h2>EXAMPLE</h2>

An example on Menotre stream (Umbria, Italy):<br />
The syntax:

<div class="code"><pre>
  r.broscoe.sh dem=dtm20_regione@AB 'thresholds=400 600 800 1000 1200 1400 1800 2000' xcoor=2291350.34 ycoor=4765192.22 lt=4 result=menotre_txt
</pre></div>

The results:
<div class="code"><pre>
threshold	t	Pr	Radj	Pvalue
400	0.5713518	0.568486	-0.003798402	0.6085511
600	0.8791352	0.3810997	-0.001896266	0.2798474
800	1.053110	0.2948033	0.001067895	0.29454
1000	0.02578308	0.9794938	-0.01233737	0.8535388
1200	0.3985548	0.69147		-0.01234108	0.6340721
1400	-1.024254	0.3100425	0.0008457844	0.256408
1800	-0.6368832	0.5274277	-0.01309044	0.5764749
2000	-0.4003206	0.6908575	-0.01901582	0.814699
</pre></div>
<br />
<img src="images/wt_rbroscoe.jpg"> <img src="images/lr_rbroscoe.jpg"> <img src="images/at_rbroscoe.jpg"> <br />
<br />
By the report and graphics, you can see that the Van der Werden test gives not-so-good results (<em>Pvalue_max</em>=0.85 for threshold=1000 cells) but, if you consider the linear regression output (<em>Pr</em>), you can see that for the same threshold value (1000 cells) <em>Pr</em> is 97%.<br />
So the threshold=1000 cells is chosen. Moreover the program returns a set of vector map called <em>"orderd_thresholdvalue"</em> from wich you can extract the right one orderd-network (in this case the right one is <em>"orderd_1000"</em>), you can rename and use it as well as you want.<br />
<br />
<img src="images/menotre.jpg"><br />
<br />
<h2>NOTES</h2>
The <em>lt</em> value requested in input is a parameter that prevents eventual errors in the DEM; it considers the presence of pits and represents the height difference <em>lesserthan</em> a drop is not considered as a drop but as a pit, and extracted from <em>Mean Stream Drop</em> analysis.<br />
<br />
The program uses the module <em><a href="r.strahler.html">r.strahler</a></em>, so it presents the same conditions about the selection of a threshold value range.<br /> 

<h2>SEE ALSO</h2>
<em><a href="v.strahler.html">v.strahler</a></em><br>
<em><a href="r.strahler.sh.html">r.strahler.sh</a></em><br>

<h2>REFERENCES</h2>
NIST, (2006). <i>Van Der Waerden.</i><br />
URL:  <em><a href="http://www.itl.nist.gov/div898/software/dataplot/refman1/auxillar/vanderwa.htm">http://www.itl.nist.gov/div898/software/dataplot/refman1/auxillar/vanderwa.htm</a></em><br />
<p>
D. G. Tarboton and D. P. Ames, (2001). <i>Advances in the mapping of flow networks from digital elevation data.</i><b> World Water and Environment Resources Congress</b>, presentation (2001).<br />
<p>
J. J. Flint, (1974). <i>Stream gradient as a function of order, magnitude, and discharge.</i><b> Water Resources Research</b>, vol.10, n.5, p.969-973. <br />
<p>
NIST, (2006). <i>Engineering statistical handbook: confidence limits for the mean.</i><br />
URL:  <em><a href="http://www.itl.nist.gov/div898/handbook/eda/section3/eda352.htm">http://www.itl.nist.gov/div898/handbook/eda/section3/eda352.htm</a></em><br />
<p>
J. C. Davis, (1990). <i>Statistics and Data Analysis in Geology</i>. John Wiley \& Sons editors (New York, NY, USA).<br />
<p>
A. J. Broscoe, (1959). <i>Quantitative analysis of longitudinal stream profiles of small watersheds</i>. Department of Geology, Columbia University, NY.<br />
<p>
F. De Mendiburu, (2006). <i>Statistical Procedures for Agricultural Research.</i><br />
URL:  <em><a href="http://rss.acs.unt.edu/Rdoc/library/agricolae/html/agricolae.package.html">http://rss.acs.unt.edu/Rdoc/library/agricolae/html/agricolae.package.html</a></em><br />

<h2>AUTHORS</h2>

Ivan Marchesini and Annalisa Minelli, Univ. Perugia. <br>

<p>
<i>Last changed: $Date$</i>
<HR>
<p><a href="index.html">Main index</a> - <a href="raster.html">raster index</a> - <a href="full_index.html">Full index</a></P>
</body>
</html>
