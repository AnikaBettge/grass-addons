<h2>DESCRIPTION</h2>

<em>r.series.lwr</em> performs a local weighted regression (LWR) of 
time series in order to estimate missing values and identify outliers. 
For each input map, an output map with the suffix <em>suffix</em> 
(default: _lwr) is created.

<p>
For each point in the time series, the (in time) neighboring points are 
considered to estimate a polynomial function that best fits the 
observations. The points are weighted according to their distance (in 
time) to the current point with points farther away getting a lower 
weight.

<p>
The option <b>order</b> determines the order of the polynomial function 
used to fit the observations. An order of 1 is a linear regression, 
recommended and default is <em>order=2</em>. An order of 3 might cause 
over-fitting, resulting in no smoothing, and should only be used with 
data that show high fluctuations.

<p>
The <em>delta</em> option is experimental. It smoothes the polynomial 
function: with a high <em>delta</em> value, a higher order polynomial 
function fitting becomes similar to a moving average.

<p>
Optionally, outliers can be removed with the <em>-l</em> and 
<em>-h</em> flags when fitting a polynomial. In this case, a fit error 
tolerance (option <em>fit</em>) must be provided. These flags are 
slowing down the module and are only needed when the time series 
contains many outliers. A few outliers are handled well with the 
default settings.

<h2>NOTES</h2>

If the <em>range</em> option is given, any values which fall outside
that range will be treated as if they were NULL.
The <em>range</em> parameter can be set to <em>low,high</em> thresholds:
values outside of this range are treated as NULL.

<p>
The <em>low,high</em> thresholds are floating point, so use 
<em>-inf</em> or <em>inf</em> for a single threshold (e.g., 
<em>range=0,inf</em> to ignore negative values, or 
<em>range=-inf,-200.4</em> to ignore values above -200.4).

<p>
The maximum number of raster maps that can be processed is given by the 
per-user limit of the operating system. For example, the soft limits 
for users are typically 1024. The soft limit can be changed with e.g. 
<tt>ulimit -n 4096</tt> (UNIX-based operating systems) but not higher 
than the hard limit. If it is too low, you can as superuser add an 
entry in

<div class="code"><pre>
/etc/security/limits.conf
# &lt;domain&gt;      &lt;type&gt;  &lt;item&gt;         &lt;value&gt;
your_username  hard    nofile          4096
</pre></div>

This would raise the hard limit to 4096 files. Also have a look at the 
overall limit of the operating system
<div class="code"><pre>
cat /proc/sys/fs/file-max
</pre></div>
which is on modern Linux systems several 100,000 files.

<p>Use the <em>-z</em> flag to analyze large amount of raster maps 
without hitting open files limit and the size limit of command line 
arguments. This will however increase the processing time. For every 
single row in the output map(s) all input maps are opened and closed. 
The amount of RAM will rise linear with the number of specified input 
maps.
<p>
The input and file options are mutually exclusive. Input is a 
text file with a new line separated list of raster map names.

<h2>SEE ALSO</h2>

<em><a href="r.series.html">r.series</a></em>, 
<em><a href="r.hants.html">r.hants</a></em>

<h2>AUTHOR</h2>

Markus Metz

<p><i>Last changed: $Date$</i>
