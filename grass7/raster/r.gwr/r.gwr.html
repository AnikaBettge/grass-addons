<h2>DESCRIPTION</h2>

<em>r.gwr</em> calculates a geographically weighted multiple linear 
regression from raster maps, according to the formula
<div class="code"><pre>
Y = b0 + sum(bi*Xi) + E
</pre></div>
where
<div class="code"><pre>
X = {X1, X2, ..., Xm}
m = number of explaining variables
Y = {y1, y2, ..., yn}
Xi = {xi1, xi2, ..., xin}
E = {e1, e2, ..., en}
n = number of observations (cases)
</pre></div>

In R notation:
<div class="code"><pre>
Y ~ sum(bi*Xi)
b0 is the intercept, X0 is set to 1
</pre></div>

<p>
The b coefficients are localized, i.e. determined for each cell 
individually.

<p>
Geographically weighted regressions should be used as a diagnostic tool 
and not as an interpolation method. If a geographically weighted 
regression provides a higher R<sup>2</sup> than the corresponding 
global regression, a crucial predictor is missing in the model. If that 
missing predictor can not be estimated or is supposed to behave 
randomly, a geographically weighted regression might be used for 
interpolation, but the result, in particular the variation of the 
&beta; coefficients needs to be judged according to prior assumptions.

<p>
<em>r.gwr</em> is designed for large datasets that can not be processed 
in R. A p value is therefore not provided, because even very small, 
meaningless effects will become significant with a large number of 
cells. Instead it is recommended to judge by the amount of variance 
explained (R squared for a given variable) and the gain in AIC (AIC 
without a given variable minus AIC global must be positive) whether the 
inclusion of a given explaining variable in the model is justified.

<h4>The explaining variables</h4>
R squared for each explaining variable represents the additional amount
of explained variance when including this variable compared to when
excluding this variable, that is, this amount of variance is explained
by the current explaining variable after taking into consideration all
the other explaining variables.
<p>
The F score for each explaining variable allows to test if the inclusion
of this variable significantly increases the explaining power of the
model, relative to the global model excluding this explaining variable.
That means that the F value for a given explaining variable is only
identical to the F value of the R-function <em>summary.aov</em> if the
given explaining variable is the last variable in the R-formula. While
R successively includes one variable after another in the order
specified by the formula and at each step calculates the F value
expressing the gain by including the current variable in addition to the
previous variables, <em>r.regression.multi</em> calculates the F-value
expressing the gain by including the current variable in addition to all
other variables, not only the previous variables.


<h2>BUGS</h2>

The estimated bandwidth is too small. A correcting factor has been 
introduced, but this is just a workaround.

<h2>AUTHOR</h2>

Markus Metz

<p><i>Last changed: $Date$</i>
