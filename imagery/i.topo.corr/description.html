<H2>DESCRIPTION</H2>

<p><EM>i.topo.corr</EM> is used to topographically correct reflectance from imagery files, e.g. obtained with <EM>i.landsat.toar</EM>, using a sun illumination terrain model. This illumination model represents the cosine of the incident angle, i.e. the  angle between the normal to the ground and the sun rays. It can be obtained with <em>r.sun</em> (parameter incidout), and then calculating its cosine with float precission.</p>

<p>Using flag -i and given an elevation map as basemap (UTM), <em>i.topo.corr</em> permits to obtain a simple illumination model from the formula:
<ul>
	<li> cos_i = cos(s) · cos(z) + sin(s) · sin(z) · sin(a - o) </li>
</ul>
where,
<em>s</em> is the terrain slope angle, <em>z</em> is the solar zenith angle, <em>a</em> the solar azimuth angle, <em>o</em> the terrain aspect angle.</p>

<p>For each band file, the corrected reflectance (ref_c) is calculate from the original reflectance (ref_o) using one of the three offered methods (one lambertian and two non-lambertian).</p>

<H3>Method: cosine</H3>

<p>
<ul>
	<li> ref_c = ref_o · cos_z / cos_i </li>
</ul>
</p>


<H3>Method: minnaert</H3>

<p>
<ul>
	<li>ref_c = ref_o · (cos_z / cos_i) ^ k</li>
</ul>
where,
<em>k</em> is obtained by linear regression of ln(ref_o) = ln(ref_c) - k ln(cos_z/cos_i)</p>

<H3>Method: c-factor</H3>

<p>
<ul>
	<li>ref_c = ref_o · (cos_z + c)/ (cos_i + c)</li>
</ul>
where,
<em>c</em> is a/m from ref_o = a + m cos_i.</p>

<H3>Method: percent</H3>

<p>I propose to test a new method. As cos_i varies from -1 to +1, then (cos_i + 1)/2 varied from 0 (surface in the side in opposition to the sun: infinite correction) to 1 (direct exhibition to the sun: no correction) and it can be calculated as
<ul>
	<li>ref_c = ref_o · 2 / (cos_i + 1)</li>
</ul>
</p>


<H2>NOTES</H2>

<ol>
	<li>The illumination model (cos_i) with flag -i uses the actual region as limits and the resolution of the elevation map.</li>
	<li>The topographic correction use the full reflectance file (null remain null) and its resolution.</li>
	<li>The elevation map to calculate the illumination model should be UTM.</li>
</ol>

<H2>EXAMPLES</H2>

<p>First, make a illumination model from the SRTM map, and then make topographic correction of the bands toar.5, toar.4 and toar.3 with output as tcor.toar.5, tcor.toar.4, and tcor.toar.3 using c-factor (= c-correction) method.</p>

<div class="code">
<pre>
i.topo.corr -i base=SRTM zenith=33.3631 azimuth=59.8897 out=cosi
i.topo.corr base=cosi input=toar.5,toar.4,toar.3 out=tcor zenith=33.3631 method=c-factor</pre>
</div>

<H2>REFERENCES</H2>

<ul>
	<li>Law K.H. and Nichol J. Topographic Correction For Differential Illumination Effects On Ikonos Satellite Imagery.</li>
	<li>Meyer P. et al. Radiometric Corrections Of Topographically Induced Effects On Landsat Tm Data In Alpine Terrain</li>
	<li>Riaño et al. Assessment of Different Topographic Corrections in Landsat-TM Data for Mapping Vegetation Types. IEEE Transactions On Geoscience And Remote Sensing, Vol. 41, No. 5, May 2003</li>
	<li>Twele A. and Erasmi S. Evaluating topographic correction algorithms for improved land cover discrimination in mountainous areas of Central Sulawesi. Göttinger Geographische Abhandlungen, vol. 113, 2005.</li>
</ul>



<H2>SEE ALSO</H2>

<em>
<A HREF="i.landsat.toar">i.landsat.toar</A>,
<A HREF="r.mapcalc.html">r.mapcalc</A>,
<A HREF="r.sun">r.sun</A>
</em>


<H2>AUTHOR</H2>

E. Jorge Tizado  (ej.tizado unileon es)<br>
Dept. Biodiversity and Environmental Management, University of León, Spain<BR>

<p>
<i>Last changed: $Date: 2008/02/10 00:00:00 $</i>
