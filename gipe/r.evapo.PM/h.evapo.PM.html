<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=windows-1252">
	<TITLE>r.flow</TITLE>
	<META NAME="GENERATOR" CONTENT="OpenOffice.org 1.1.5  (Win32)">
	<META NAME="CREATED" CONTENT="20060113;19305523">
	<META NAME="CHANGEDBY" CONTENT="Massimiliano Cannata">
	<META NAME="CHANGED" CONTENT="20060116;11204944">
	<STYLE>
	<!--
		@page { size: 21cm 29.7cm }
	-->
	</STYLE>
</HEAD>
<BODY LANG="it-IT" BGCOLOR="#ffffff" DIR="LTR">
<P STYLE="margin-bottom: 0cm"><IMG SRC="../../../grass.smlogo.gif" NAME="Graphic1" ALT="GRASS logo" ALIGN=BOTTOM WIDTH=75 HEIGHT=38 BORDER=0></P>
<HR SIZE=5 NOSHADE>
<H2>NAME</H2>
<P><EM><B>h.evapo.PM</B></EM> &ndash; Calculate potential
evapotranspiration with a Penman-Monteith approach. 
</P>
<H2>SYNOPSIS</H2>
<P><B>h.evapo.PM</B><BR><B>h.evapo.PM help</B><BR><B>h.evapo.PM</B>
[-<B>qzd</B>] <B>DEM</B>=<EM>string</EM> <B>T</B>=<EM>string
<B>RU</B></EM>=<EM>string <B>WS</B></EM>=<EM>integer <B>NSR</B></EM>=<EM>integer
<B>hc</B></EM>=<EM>string <B>EPo</B></EM>=<EM>string</EM></P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<H3>Flags:</H3>
<DL>
	<DT><B>-q</B> 
	</DT><DD>
	Quiet operation 
	</DD><DT>
	<B>-z</B> 
	</DT><DD>
	Set negative evapotrnspiration to zero (condensation) 
	</DD><DT>
	<B>-d</B> 
	</DT><DD STYLE="margin-bottom: 0.5cm">
	Daytime calculation 
	</DD></DL>
<H3>
Parameters:</H3>
<DL>
	<DT><B>DEM</B>=<EM>string</EM> 
	</DT><DD>
	Input elevation raster file 
	</DD><DT>
	<B>T</B>=<EM>string</EM> 
	</DT><DD>
	Input temperature raster file <SPAN LANG="en-US">[&deg;C]</SPAN></DD><DT>
	<B>RU</B>=<EM>string</EM> 
	</DT><DD>
	Input Relative Humidity raster file [%]</DD><DT>
	<B>WS</B>=<EM>integer</EM> 
	</DT><DD>
	Input Wind Speed raster file [m/s]</DD><DT>
	<B>NSR</B>=<EM>integer</EM> 
	</DT><DD>
	Input Net Solar Radiation raster file [ X ]</DD><DT>
	<B>hc</B>=<EM>string</EM> 
	</DT><DD>
	Input Canopy heigth raster file [m]</DD><DT>
	<B>EPo</B>=<EM>string</EM> 
	</DT><DD>
	Output Potential Evapotranspiration file [mm/h]</DD><DT STYLE="margin-bottom: 0.5cm">
	<BR><BR>
	</DT></DL>
<H2>
DESCRIPTION</H2>
<P LANG="en-US">This program estimates the Potential
evapotranspiration EPo [mm/h] by using a Penman-Monteith approach
from a set of input raster maps: <I>DEM</I> (integer or floating
point), the temperature <I>T </I>[&deg;C], the relative humidity <I>RU</I>
[%], the wind speed <I>WS</I> [m/s], the net solar radiation <I>NSR</I>
[ X ], the canopy heigth <I>hc</I> [m].</P>
<P LANG="en-US"><SPAN LANG="en-US"><I>T</I>, <I>RU</I>, <I>WS</I>,
<I>NRS</I><SPAN STYLE="font-style: normal"> and </SPAN><I>hc</I>
could be estimated by means of interpolated point wise observations
(climatological stations), remote sensing, and/or other model output.</SPAN></P>
<P LANG="en-US"><SPAN LANG="en-US">Evapotranspiration is composed by
a radiative term and an aerodynamic term: where <I>hc</I><FONT FACE="Times New Roman, serif"><FONT FACE="Times New Roman, serif">&ge;</FONT></FONT>0
(vegetation is present) the evapotranspiration is calculated by means
of Penman-Monteith formulation [Richard et al., 1998], where <I>hc</I>&lt;0
(vegetation is not present: e.g. lakes, rivers or seas) evaporation
is calculated by means of original Penman formulation [Penman, 1963].
  <BR>&nbsp; </SPAN>
</P>
<H2>NOTES</H2>
<P>For best results, use input elevation maps with high precision
units (e.g., centimeters) so that flowlines do not terminate
prematurely in flat areas. To prevent the creation of tiny flowline
segments with imperceivable changes in elevation, an endpoint which
would land very close to the center of a grid cell is quantized to
the exact center of that cell. The maximum distance between the
intercepts along each axis of a single diagonal segment and another
segment of 1/2 degree different aspect is taken to be &quot;very
close&quot; for that axis. Note that this distance (the so-called
&quot;quantization error&quot;) is about 1-2% of the resolution on
maps with square cells. 
</P>
<P>The values in length maps computed using the <B>-u</B> flag
represent the distances from each cell to an upland flat or singular
point. Such distances are useful in water erosion modeling for
computation of the LS factor in the standard form of USLE. Uphill
flowlines merge on ridge lines; by redirecting the order of the
flowline points in the output vector map, dispersed waterflow can be
simulated. The density map can be used for the extraction of ridge
lines. 
</P>
<P>Computing the flowlines downhill simulates the actual flow (also
known as the raindrop method). These flowlines tend to merge in
valleys; they can be used for localization of areas with waterflow
accumulation and for the extraction of channels. The downslope
flowline density multiplied by the resolution can be used as an
approximation of the upslope contributing area per unit contour
width. This area is a measure of potential water flux for the steady
state conditions and can be used in the modeling of water erosion for
the computation of the unit stream power based LS factor or sediment
transport capacity. 
</P>
<P>The program has been designed for modeling erosion on hillslopes
and has rather strict conditions for ending flowlines. It is
therefore not very suitable for the extraction of stream networks or
delineation of watersheds unless a DEM without pits or flat areas is
available (<A HREF="../../../r.fill.dir.html">r.fill.dir</A> can be
used to fill pits). 
</P>
<P>To label the vector flowlines automatically, the user can use
<A HREF="../../../v.category.html">v.category</A> (add categories). 
</P>
<H2>Algorithm background</H2>
<P>1. Construction of flow-lines (slope-lines): r.flow uses an
original vector-grid algorithm which uses an infinite number of
directions between 0.0000... and 360.0000... and traces the flow as a
line (vector) in the direction of gradient (rather than from cell to
cell in one of the 8 directions = D-infinity algorithm). They are
traced in any direction using aspect (so there is no limitation to 8
directions here). The D8 algorithm produces zig-zag lines. The value
in the outlet is very similar for both r.flow and <A HREF="../../../r.flowmd.html">r.flowmd</A>
algorithms (because it is essentially the watershed area), however
the spatial distribution of flow, especially on hillslopes is quite
different. It is still a 1D flow routing so the dispersal flow is not
accurately described, but still better than D8. 
</P>
<P>2. Computation of contributing areas: r.flow uses a single flow
algorithm, i.e. all flow is transported to a single cell downslope. 
</P>
<H2>FURTHER NOTES</H2>
<P>Differences between <EM>r.flow</EM> and <EM>r.flowmd</EM> 
</P>
<OL>
	<LI><P STYLE="margin-bottom: 0cm">r.flow has an option to compute
	slope and aspect internally thus making the program capable to
	process much larger data sets than r.flowmd. It has also 2
	additional options for handling of large data sets but it is not
	known that they work properly. 
	</P>
	<LI><P STYLE="margin-bottom: 0cm">the programs handle the special
	cases when the flowline passes exactly (or very close) through the
	grid vertices differently. 
	</P>
	<LI><P>r.flowmd has the simplified multiple flow addition so the
	results are smoother. 
	</P>
</OL>
<P>In conclusion, <EM>r.flowmd</EM> produces nicer results but is
slower and it does not support as large data sets as <EM>r.flow</EM>.
</P>
<H2>DIAGNOSTICS</H2>
<P>ERROR: GISRC - variable not set 
</P>
<P>The program was run outside of GRASS. 
</P>
<P>Usage: r.flow [-u3mMqh] elevin=name [aspin=name] [barin=name]
[skip=value] [bound=value] [offset=value] [flout=name] [lgout=name]
[dsout=name] 
</P>
<P>Invalid options were specified on the command line. 
</P>
<P>ERROR: r.flow: error getting current region 
</P>
<P>ERROR: r.flow: unable to reset current region 
</P>
<P>ERROR: r.flow: cannot open vector file 
</P>
<P>&quot;ERROR: r.flow: cell file &quot; filename &quot; not found&quot;
</P>
<P>&quot;ERROR: r.flow: cannot get header for &quot; filename 
</P>
<P>&quot;ERROR: r.flow: unable to create raster map &quot; filename 
</P>
<P>Self-explanatory or beyond explanation. 
</P>
<P>&quot;ERROR: r.flow: &quot; input &quot; file's resolution differs
from current&quot; region resolution 
</P>
<P>The resolutions of all input files and the current region must
match. 
</P>
<P>&quot;ERROR: r.flow: resolution too unbalanced (&quot; val &quot;
x &quot; val &quot;)&quot; The difference in length between the two
axes of a grid cell is so great that quantization error is larger
than one of the dimensions. Resample the map and try again. 
</P>
<H2>SEE ALSO</H2>
<P><A HREF="../../../r.basins.fill.html">r.basins.fill</A>, <A HREF="../../../r.drain.html">r.drain</A>,
<A HREF="../../../r.fill.dir.html">r.fill.dir</A>, <A HREF="../../../r.water.outlet.html">r.water.outlet</A>,
<A HREF="../../../r.watershed.html">r.watershed</A>, <A HREF="../../../v.category.html">v.category</A>,
<A HREF="../../../v.to.rast.html">v.to.rast</A> 
</P>
<H2>AUTHORS</H2>
<P><I>Original version of program:</I> <BR>Maros Zlocha and Jaroslav
Hofierka, Comenius University, Bratislava, Slovakia, 
</P>
<P><I>The current version of the program (adapted for GRASS5.0)</I>:
<BR>Joshua Caplan, Mark Ruesink, Helena Mitasova, University of
Illinois at Urbana-Champaign with support from USA
CERL.<BR><A HREF="http://skagit.meas.ncsu.edu/~helena/gmslab/">GMSL/University
of Illinois at Urbana-Champaign</A> 
</P>
<H2>REFERENCES</H2>
<P>Mitasova, H., L. Mitas, 1993, Interpolation by regularized spline
with tension : I. Theory and implementation. Mathematical Geology 25,
p. 641-655. (<A HREF="http://skagit.meas.ncsu.edu/~helena/gmslab/papers/lmg.rev1.ps">online</A>)
</P>
<P>Mitasova and Hofierka 1993 : Interpolation by Regularized Spline
with Tension: II. Application to Terrain Modeling and Surface
Geometry Analysis. Mathematical Geology 25(6), 657-669. (<A HREF="http://skagit.meas.ncsu.edu/~helena/gmslab/papers/hmg.rev1.ps">online</A>)
</P>
<P>Mitasova, H., Mitas, L., Brown, W.M., Gerdes, D.P., Kosinovsky,
I., Baker, T., 1995: Modeling spatially and temporally distributed
phenomena: New methods and tools for GRASS GIS. International Journal
of Geographical Information Systems 9(4), 433-446. 
</P>
<P>Mitasova, H., J. Hofierka, M. Zlocha, L.R. Iverson, 1996, Modeling
topographic potential for erosion and deposition using GIS. Int.
Journal of Geographical Information Science, 10(5), 629-641. (reply
to a comment to this paper appears in 1997 in Int. Journal of
Geographical Information Science, Vol. 11, No. 6) 
</P>
<P>Mitasova, H.(1993): Surfaces and modeling. Grassclippings (winter
and spring) p.18-19. 
</P>
<P STYLE="margin-bottom: 0cm"><I>Last changed: $Date: 2005/08/30
09:58:26 $</I> 
</P>
<HR>
<P><A HREF="../../../index.html">Main index</A> - <A HREF="../../../raster.html">raster
index</A> - <A HREF="../../../full_index.html">Full index</A> 
</P>
</BODY>
</HTML>